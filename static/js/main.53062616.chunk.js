(window.webpackJsonpatp_frontend=window.webpackJsonpatp_frontend||[]).push([[0],{202:function(e,t,a){e.exports=a(376)},207:function(e,t,a){},208:function(e,t,a){},209:function(e,t,a){},312:function(e,t,a){},333:function(e,t,a){},356:function(e,t,a){},357:function(e,t,a){},372:function(e,t,a){},373:function(e,t,a){},376:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(41),o=a.n(i),l=(a(207),a(208),a(405));a(209);var s=function(){return r.a.createElement("div",{id:"the_header"},r.a.createElement(l.a,{id:"the_menu_item"},r.a.createElement(l.a.Item,{header:!0},"ATP Visualizer"),r.a.createElement(l.a.Item,{name:"XXX"}),r.a.createElement(l.a.Item,{name:"YYY"}),r.a.createElement(l.a.Item,{name:"ZZZ"})))},c=a(25),h=a(22),u=a(26),d=a(27),_=a(28),f=a(42),g=a(404),m=(a(312),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={players:[]},a}return Object(_.a)(t,e),Object(h.a)(t,[{key:"addPlayer",value:function(e,t,a){this.state.players.map(function(e){return e.id}).includes(e)||this.setState({players:[].concat(Object(f.a)(this.state.players),[{id:e,name:t,color:a}])})}},{key:"handle_button_click",value:function(e){this.setState({players:this.state.players.filter(function(t){return t.id!==e.id})}),this.props.removed_player_handler(e.id)}},{key:"render",value:function(){var e=this,t=this.state.players.map(function(t){return r.a.createElement("div",{id:"the_current_player",key:t.id},r.a.createElement(g.a,{className:"player_button",style:{backgroundColor:t.color,borderRadius:0},id:t.id,onClick:function(t,a){return e.handle_button_click(a)}},t.name),r.a.createElement("br",null),r.a.createElement("br",null))});return r.a.createElement("div",{id:"the_current_players"},t)}}]),t}(r.a.Component)),p=a(125),v=a.n(p),y=a(177),b=a(74),k=a(179),x=a(399),E=a(401),j=a(407),O=a(400),S=a(397),C=a(398),w=(a(333),a(16)),M=a(180);function I(){var e=Object(k.a)(["\n\t\t\tdisplay: block;\n\t\t\tmargin: 0 auto;\n\t\t\ttop: 120px;\n\t\t"]);return I=function(){return e},e}var P=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={loading:!1,match_data:[],color:"red"},a}return Object(_.a)(t,e),Object(h.a)(t,[{key:"set_match_data",value:function(e){this.setState({match_data:e,loading:!1})}},{key:"set_loading",value:function(e){this.setState({loading:!0,color:e})}},{key:"render",value:function(){var e=this.state.match_data.map(function(e){return e.matches.map(function(t){return r.a.createElement(S.a,{key:t.id},r.a.createElement(j.a,{align:"left"},e.name),r.a.createElement(j.a,{align:"left"},t.round),r.a.createElement(j.a,{align:"left"},t.winner.first_name+" "+t.winner.last_name),r.a.createElement(j.a,{align:"left"},t.loser.first_name+" "+t.loser.last_name),r.a.createElement(j.a,{align:"left"},t.score))})}),t=Object(w.css)(I());return 1==this.state.loading?r.a.createElement("div",{id:"the_table"},r.a.createElement(C.a,{id:"the_paper"},r.a.createElement(M.RingLoader,{css:t,color:this.state.color}))):r.a.createElement("div",{id:"the_table"},r.a.createElement(C.a,{id:"the_paper"},r.a.createElement(x.a,{size:"small"},r.a.createElement(O.a,null,r.a.createElement(S.a,null,r.a.createElement(j.a,{align:"left"},"Tournament"),r.a.createElement(j.a,{align:"left"},"Round"),r.a.createElement(j.a,{align:"left"},"Winner"),r.a.createElement(j.a,{align:"left"},"Loser"),r.a.createElement(j.a,{align:"left"},"Score"))),r.a.createElement(E.a,null,e))))}}]),t}(r.a.Component),R=(a(356),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).info_box=r.a.createRef(),a.state={datasets:[],labels:a.get_labels(20,30),start_age:20,end_age:30,available_colors:t.colors,highlight_data_idx:-1,highlight_idx1:0,highlight_idx2:0,match_data:[]},a}return Object(_.a)(t,e),Object(h.a)(t,[{key:"get_labels",value:function(e,t){if(e>=t)return[];for(var a=e+1/96,n=[];a<=t;)n.push(a),a+=1/96;return n}},{key:"generate_color",value:function(){var e=Math.round,t=Math.random;return"rgba("+e(255*t())+","+e(255*t())+","+e(255*t())+",1)"}},{key:"create_dataset",value:function(e,t,a,n,r){return{data:{my_id:n,label:a,spanGaps:!0,fill:!1,lineTension:.1,backgroundColor:r,borderColor:r,borderWidth:3,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:r,pointBackgroundColor:"#fff",pointBorderWidth:4,pointHoverRadius:7,pointHoverBackgroundColor:r,pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:1,pointRadius:1,pointHitRadius:1,data:e},dates:t,player_id:n,player_name:a}}},{key:"fetch_ranking_history",value:function(e,t,a){var n="/get_ranking_history?player_id=".concat(e,"&starting_age=").concat(t,"&ending_age=").concat(a);return fetch("https://young-meadow-84276.herokuapp.com"+n)}},{key:"fetch_significant_matches",value:function(e,t,a){var n=function(e){return e.yr+(e.mo<10?"0"+e.mo.toString():e.mo.toString())+(e.day<10?"0"+e.day.toString():e.day.toString())};t=n(t),a=n(a);var r="/get_significant_matches?player_id=".concat(e,"&date1=").concat(t,"&date2=").concat(a);return fetch("https://young-meadow-84276.herokuapp.com"+r)}},{key:"changeAgeRange",value:function(e,t){var a=this,n=this.state.datasets.map(function(e){return e.data.backgroundColor}),r=this.state.datasets.map(function(e){return e.player_id}),i=this.state.datasets.map(function(e){return e.player_name}),o=[],l=this.state.start_age,s=this.state.end_age;"max"==t?s=e:l=e;var c=this.get_labels(l,s),h=function(){var e=Object(y.a)(v.a.mark(function e(t){var u,d,_,f,g,m,p,y,b,k;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>=r.length)){e.next=3;break}return a.setState({datasets:o,labels:c,start_age:l,end_age:s}),e.abrupt("return");case 3:return"https://young-meadow-84276.herokuapp.com",u="/get_ranking_history?player_id=".concat(r[t],"&starting_age=").concat(l,"&ending_age=").concat(s),e.next=7,fetch("https://young-meadow-84276.herokuapp.com"+u);case 7:return d=e.sent,e.next=10,d.json();case 10:_=e.sent,f=_.data.map(function(e){return e.date}),g=_.data.map(function(e){return e.rank}),m=_.data.map(function(e){return e.age}),p=a.pad_ranks(g,f,m,l,s),y=p[0],b=p[1],k=a.create_dataset(y,b,i[t],r[t],n[t]),o.push(k),h(t+1);case 20:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();h(0)}},{key:"removePlayer",value:function(e){for(var t=this.state.available_colors,a=0;a<this.state.datasets.length;a++)this.state.datasets[a].player_id===e&&t.unshift(this.state.datasets[a].data.backgroundColor);this.setState({datasets:this.state.datasets.filter(function(t){return t.player_id!==e}),available_colors:t})}},{key:"get_color",value:function(){return 0==this.state.available_colors.length?this.generate_color():this.state.available_colors[0]}},{key:"pad_ranks",value:function(e,t,a,n,r){for(var i=Array(96*Math.max(r-n,0)).fill(null),o=Array(96*Math.max(r-n,0)).fill(null),l=0;l<a.length;l++)if(!(a[l]<n||a[l]>r)){var s=Math.floor((a[l]-n)/(1/96));o[s]=t[l],null===i[s]?i[s]=e[l]:i[s]=Math.min(i[s],e[l])}return[i,o]}},{key:"addPlayer",value:function(e,t){var a=this;if(!this.state.datasets.map(function(e){return e.player_id}).includes(e)){var n=this.fetch_ranking_history(e,this.state.start_age,this.state.end_age),r=this.get_color();return n.then(function(n){return n.json().then(function(n){var i=n.data.map(function(e){return e.rank}),o=n.data.map(function(e){return e.date}),l=n.data.map(function(e){return e.age}),s=a.pad_ranks(i,o,l,a.state.start_age,a.state.end_age),c=s[0],h=s[1],u=a.create_dataset(c,h,t,e,r);a.setState({datasets:[].concat(Object(f.a)(a.state.datasets),[u]),available_colors:a.state.available_colors.slice(1)})})}),r}}},{key:"collinear",value:function(e,t,a,n,r,i){return Math.abs((t-n)*(e-r)-(t-i)*(e-a))}},{key:"get_segment_intersection",value:function(e,t,a){for(var n=0;n<this.state.datasets.length;n++){var r=e.getDatasetMeta(n).data;r=r.filter(function(e){return 0==e._model.skip});for(var i=0;i<r.length-1;i++){var o=r[i]._model.x,l=r[i]._model.y,s=r[i+1]._model.x,c=r[i+1]._model.y;if(!(t<o-1||t>s+1))if(this.collinear(t,a,o,l,s,c)<300)return{data_idx:r[i]._datasetIndex,i1:r[i]._index,i2:r[i+1]._index}}}return null}},{key:"highlight_segment",value:function(e,t,a){this.setState({highlight_data_idx:e,highlight_idx1:t,highlight_idx2:a})}},{key:"handle_hover",value:function(e,t){var a=this.refs.graph.chartInstance,n=e.layerX,r=e.layerY,i=this.get_segment_intersection(a,n,r);if(null!==i){if(-1!==this.state.highlight_data_idx){if(i.i1==this.state.highlight_idx1&&i.i2==this.state.highlight_idx2)return;document.getElementById("the_table").setAttribute("style","display:none")}this.highlight_segment(i.data_idx,i.i1,i.i2),this.fetch_and_process_match_data(i.data_idx,i.i1,i.i2,n,r)}else-1!==this.state.highlight_data_idx&&(this.setState({highlight_data_idx:-1,highlight_idx1:0,highlight_idx2:0}),document.getElementById("the_table").setAttribute("style","display:none"))}},{key:"rgb2hex",value:function(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""}},{key:"position_box",value:function(e,t){var a=this.refs.graph.chartInstance.canvas,n=a.clientHeight;return e>a.clientWidth/2?t>n/2?[e-500,t-300]:[e-500,t]:t>n/2?[e,t-300]:[e,t]}},{key:"display_match_data",value:function(e){this.info_box.current.set_match_data(e.data)}},{key:"fetch_and_process_match_data",value:function(e,t,a,n,r){var i=this,o=this.state.datasets[e].data.borderColor;this.info_box.current.set_loading(o);var l=this.position_box(n,r);document.getElementById("the_table").setAttribute("style","display:block; left:".concat(l[0],"px; top:").concat(l[1],"px; border: 10px solid ").concat(this.rgb2hex(o)));var s=this.state.datasets[e].player_id,c=this.state.datasets[e].dates[t],h=this.state.datasets[e].dates[a];this.fetch_significant_matches(s,c,h).then(function(e){return e.json().then(function(e){i.display_match_data(e,n,r,o)})})}},{key:"render",value:function(){var e,t=this,a=this.state.datasets.map(function(e){return e.data}),n=this.state.end_age-this.state.start_age;e=n>5?Math.floor(n):10;this.refs.graph;var i={scales:{yAxes:[{scaleLabel:{labelString:"Ranking",display:!0}}],xAxes:[{scaleLabel:{labelString:"Age",display:!0},ticks:{maxTicksLimit:e,autoSkip:!0,callback:function(e,t,a){if(n>5)return Math.floor(e).toString();var r,i=(r=e,r-=Math.floor(r),Math.ceil(12*r));return 0==i?Math.floor(e).toString():Math.floor(e).toString()+"."+i.toString()}}}]},tooltips:{enabled:!1},legend:{onClick:function(e){return e.stopPropagation()},display:!1},onHover:function(e,a){return t.handle_hover(e,a)}},o={labels:this.state.labels,datasets:a},l=this;return b.a.controllers.myLine=b.a.controllers.line.extend({draw:function(){if(b.a.controllers.line.prototype.draw.apply(this,arguments),-1!=l.state.highlight_data_idx){var e=this.chart.getDatasetMeta(l.state.highlight_data_idx),t=this.chart.ctx,a=e.dataset._model.borderColor;t.strokeStyle=a.substr(0,a.length-2)+"0.3)",t.lineWidth=10,t.beginPath();var n=e.data[l.state.highlight_idx1];t.moveTo(n._model.x,n._model.y);var r=e.data[l.state.highlight_idx2];t.bezierCurveTo(n._model.x,n._model.y,n._model.controlPointNextX,n._model.controlPointNextY,r._model.x,r._model.y),t.stroke()}}}),r.a.createElement("div",null,r.a.createElement("div",{id:"the_chart"},r.a.createElement(b.b,{type:"myLine",ref:"graph",data:o,options:i})),r.a.createElement(P,{ref:this.info_box}))}}]),t}(r.a.Component));R.colors=["rgb(76, 128, 24, 1)","rgb(24, 76, 128, 1)","rgb(128, 24, 128, 1)","rgb(216, 12, 12, 1)","rgb(225, 122, 19, 1)","rgb(19, 225, 225, 1)","rgb(68, 97, 39, 1)","rgb(97, 39, 39, 1)"];var B=R,A=a(403),L=(a(357),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={players:[],loading:!1,placeholder:"Select a Player",hovered_player:null},a}return Object(_.a)(t,e),Object(h.a)(t,[{key:"convert_data",value:function(e){for(var t=[],a=0;a<e.length;a++){var n=e[a];t.push({text:n.last_name.concat(", ",n.first_name),value:n.id,key:n.id})}return t}},{key:"componentDidMount",value:function(){var e=this;fetch("https://young-meadow-84276.herokuapp.com/topTenPlayers").then(function(t){return t.json().then(function(t){e.setState({players:e.convert_data(t.data)})})})}},{key:"search_change",value:function(e){var t=this;this.setState({loading:!0});var a=e.searchQuery;if(0==a.length){var n="https://young-meadow-84276.herokuapp.com";fetch(n+"/topTenPlayers").then(function(e){return e.json().then(function(e){console.log(e),t.setState({players:t.convert_data(e.data),loading:!1})})})}else{n="https://young-meadow-84276.herokuapp.com";fetch(n+"/topTenFiltered?prefix=".concat(a)).then(function(e){return e.json().then(function(e){console.log(e),t.setState({players:t.convert_data(e.data),loading:!1})})})}}},{key:"label_click",value:function(e){for(var t=null,a=e.value,n=0;n<e.options.length;n++)e.options[n].value==a&&(t=e.options[n].text);this.props.added_player_handler(a,t)}},{key:"close",value:function(e){console.log(e)}},{key:"open",value:function(e){this.setState({placeholder:""})}},{key:"focus",value:function(e){console.log("focus")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"the_player_selector"},r.a.createElement(A.a,{loading:this.state.loading,selectOnBlur:!1,search:!0,selection:!0,onChange:function(t,a){return e.label_click(a)},onSearchChange:function(t,a){return e.search_change(a)},options:this.state.players,onClose:function(t,a){return e.close(a)},onOpen:function(t,a){return e.open(a)},onFocus:function(t,a){return e.focus(a)},text:"Search a player..."}))}}]),t}(r.a.Component)),T=a(402),W=a(23),D=(a(372),function(e){function t(e){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).call(this,e))}return Object(_.a)(t,e),Object(h.a)(t,[{key:"max_change",value:function(e){this.props.slider_handler(e,"max")}},{key:"min_change",value:function(e){this.props.slider_handler(e,"min")}},{key:"render",value:function(){var e=this;var t=Object(W.a)({root:{color:"#2522e0",height:8},thumb:{height:24,width:24,backgroundColor:"#fff",border:"2px solid currentColor",marginTop:-8,marginLeft:-12,"&:focus,&:hover,&$active":{boxShadow:"inherit"}},active:{},valueLabel:{left:"calc(-50% + 4px)"},track:{height:8,borderRadius:4},rail:{height:8,borderRadius:4}})(T.a);return r.a.createElement("div",{id:"the_age_slider"},r.a.createElement(t,{valueLabelDisplay:"auto","aria-label":"pretto slider",defaultValue:20,onChangeCommitted:function(t,a){return e.min_change(a)},min:10,max:50}),r.a.createElement(t,{valueLabelDisplay:"auto","aria-label":"pretto slider",defaultValue:30,onChangeCommitted:function(t,a){return e.max_change(a)},min:10,max:50}))}}]),t}(r.a.Component)),H=(a(373),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).graph=r.a.createRef(),a.current_players=r.a.createRef(),a}return Object(_.a)(t,e),Object(h.a)(t,[{key:"handle_slider_change",value:function(e,t){this.graph.current.changeAgeRange(e,t)}},{key:"handle_added_player",value:function(e,t){var a=this.graph.current.addPlayer(e,t);this.current_players.current.addPlayer(e,t,a)}},{key:"handle_removed_player",value:function(e){this.graph.current.removePlayer(e)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"the_age_comparison"},r.a.createElement("div",{id:"player_selector_and_current_players"},r.a.createElement(L,{added_player_handler:function(t,a){return e.handle_added_player(t,a)}}),r.a.createElement(m,{ref:this.current_players,removed_player_handler:function(t){return e.handle_removed_player(t)}})),r.a.createElement("div",{id:"chart_and_slider"},r.a.createElement(B,{ref:this.graph}),r.a.createElement(D,{slider_handler:function(t,a){return e.handle_slider_change(t,a)}})))}}]),t}(r.a.Component)),X=function(e){function t(e){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).call(this,e))}return Object(_.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,"h2h")}}]),t}(r.a.Component),Y=a(189),z=a(51);var J=function(){return r.a.createElement("div",{id:"the_app"},r.a.createElement(s,null),r.a.createElement(Y.a,null,r.a.createElement(z.c,null,r.a.createElement(z.a,{exact:!0,path:"/",component:H}),r.a.createElement(z.a,{path:"/h2h",component:X}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(375);o.a.render(r.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[202,1,2]]]);
//# sourceMappingURL=main.53062616.chunk.js.map